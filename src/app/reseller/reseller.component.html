<div class="container my-4" *ngIf="reseller">
  <!-- Sezione Informazioni Rivenditore con effetto satinato -->
  <div class="reseller-info-satin mb-5 p-4">
    <div class="row">
      <!-- Colonna Info Principali -->
      <div class="col-md-8">
        <div class="d-flex flex-wrap align-items-center mb-3">
          <div class="info-img text-center me-3">
            <img
              [src]="imgUrl + reseller.avatar"
              alt="Foto Rivenditore"
              class="img-fluid rounded-circle"
              style="max-width: 200px"
            />
            <!-- Pulsante per caricare nuovo prodotto (solo per il proprietario) -->
            <div *ngIf="isOwner" class="mt-3">
              <button
                class="btn btn-primary"
                routerLink="/reseller/new-autopart"
              >
                Carica nuovo prodotto
              </button>
            </div>
          </div>
          <div class="info-text mt-3">
            <h2>{{ reseller.username }}</h2>
            <p><strong>Email:</strong> {{ reseller.email }}</p>
            <p><strong>Nome:</strong> {{ reseller.name }}</p>
            <p><strong>Cognome:</strong> {{ reseller.surname }}</p>
            <p><strong>Telefono:</strong> {{ reseller.phoneNumber }}</p>
            <p>
              <strong>Ragione Sociale:</strong> {{ reseller.ragioneSociale }}
            </p>
            <p><strong>Partita IVA:</strong> {{ reseller.partitaIva }}</p>
            <p>
              <strong>Sito Web:</strong>
              <a [href]="reseller.sitoWeb" target="_blank">{{
                reseller.sitoWeb
              }}</a>
            </p>
            <p>
              <strong>Rating medio:</strong>
              {{ reseller.ratingMedio | number : "1.1-1" }} / 5
            </p>
          </div>
        </div>
      </div>
      <!-- Colonna Form Recensione -->
      <div *ngIf="!isOwner && userRole === 'ROLE_USER'" class="col-md-4">
        <div class="review-form p-3">
          <h3 class="mb-3">Lascia la tua valutazione</h3>
          <form (ngSubmit)="submitRating()">
            <div class="form-group mb-2">
              <label for="ratingSelect">Voto (1-5):</label>
              <select
                id="ratingSelect"
                [(ngModel)]="newRating.rating"
                name="rating"
                required
                class="form-control"
              >
                <option *ngFor="let r of [1, 2, 3, 4, 5]" [value]="r">
                  {{ r }}
                </option>
              </select>
            </div>
            <div class="form-group mb-2">
              <label for="ratingComment">Commento (opzionale):</label>
              <textarea
                id="ratingComment"
                [(ngModel)]="newRating.comment"
                name="comment"
                class="form-control"
                rows="3"
              ></textarea>
            </div>
            <button type="submit" class="btn btn-primary mt-2 w-100">
              Invia valutazione
            </button>
          </form>
        </div>
      </div>
    </div>
  </div>

  <!-- Sezione Prodotti del Rivenditore -->
  <div class="row">
    <h3 class="mb-3">Prodotti del Rivenditore</h3>
    <div
      *ngFor="let autopart of autoparts"
      class="col-12 col-sm-6 col-md-4 col-lg-3 mb-4"
    >
      <div class="card h-100">
        <img
          [src]="imgUrl + autopart.immagine || 'assets/placeholder.png'"
          class="card-img-top img-fluid p-3"
          alt="{{ autopart.nome }}"
        />
        <div class="card-body">
          <h5 class="card-title">{{ autopart.nome }}</h5>
          <p class="card-text">{{ autopart.descrizione }}</p>
          <p class="card-text">
            <strong>Prezzo:</strong>
            {{ autopart.prezzi[0].importo | currency : "EUR" }}
          </p>
          <p class="card-text">
            <strong>Codice OE:</strong> {{ autopart.codiceOe }}
          </p>
        </div>
        <div class="card-footer">
          <div *ngIf="isOwner">
            <button
              class="btn btn-warning btn-sm me-2"
              [routerLink]="['/reseller/edit-autopart', autopart.id]"
            >
              Modifica
            </button>
            <button
              class="btn btn-danger btn-sm"
              (click)="deleteAutopart(autopart.id)"
            >
              Elimina
            </button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
